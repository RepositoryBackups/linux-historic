Thu Sep 11 08:43:03 PDT 1997  Richard Henderson  <rth@cygnus.com>

	* Release version 2.1.55.

Wed Sep 10 16:34:41 PDT 1997  Richard Henderson  <rth@cygnus.com>

	* genksyms/genksyms.c (crc_prefix): New variable.
	(export_symbol): Use it.
	(main): New option -p sets it.
	* man/genksyms.8: Update documentation.
	Idea from Jacques Gelinas <jack@solucorp.qc.ca>.

Wed Sep 10 16:09:37 PDT 1997  Richard Henderson  <rth@cygnus.com>

	* insmod/Makefile: Allow insmod & rmmod to run as a combined binary.
	* insmod/main.c: New file.
	* Makeconfig (COMBINE_INSMOD_RMMOD): New define.
	Requested by Erik Troan <ewt@redhat.com>.

Wed Sep 10 15:41:16 PDT 1997  Richard Henderson  <rth@cygnus.com>

	* depmod/depmod.c (load_obj_file): Print error if fopen fails.
	(main): Continue processing on errors, so that we see all errors
	all at once.
	Reported by Gunther Mayer <gunther.mayer@braunschweig.netsurf.de>.

Tue Aug 26 11:14:36 -0400 1997  Telly Mavroidis  <mavroidi@ctc-fund.com>

	* util/sys_qm.c [__sparc__]: Fix typo.

Tue Jul 29 23:02:04 PDT 1997  Richard Henderson  <richard@gnu.ai.mit.edu>

	* include/module.h: Rename sizeof_type to tgt_sizeof_type.  Kill
	the struct duplication by defining a tgt_long.
	* insmod/insmod.c: Propogate sizeof_type change.

Tue Jul 29 22:23:16 PDT 1997  Jakub Jelinek  <jj@sunsite.mff.cuni.cz>

	* insmod/insmod.c (search_module_path): Add ipv6.

Tue Jul 29 22:23:16 PDT 1997  Jakub Jelinek  <jj@sunsite.mff.cuni.cz>

	Sparc64 support:
	* depmod/Makefile (DEFS): Pass in ARCH as well.
	* insmod/Makefile: Likewise.
	* obj/Makefile: Likewise.

	* insmod/insmod.c: Don't use native sizeof(type), use constants
	sizeof_type that correspond to the target.
	* include/module.h: Detect and cope with sparc64 target and
	sparc32 host.

	* include/obj.h: libc5 doesn't declare ELF64_ST_INFO either.

	* include/elf_sparc64.h: New file.
	* obj/obj_sparc64.c: New file.

Sat Jul 19 23:56:02 +0200 1997  Florian La Roche  <florian@knorke.saar.de>

	* depmod/misc.c (resolve_string): Kill assignment warning.
	* genksyms/genksyms.h: Extern outfile and debugfile properly.
	* man/modprobe.1: New file.

Wed Apr 16 15:27:17 +1000 1997  Paul Mackerras  <paulus@cs.anu.edu.au>

	* include/elf_ppc.h, obj/obj_ppc.c: New files.

Mon Apr 14 20:33:56 CDT 1997  Richard Henderson  <rth@tamu.edu>

	* depmod/depmod.c (print_deps_file): Fix initial array
	allocation size.

Sat Apr 12 19:23:25 CDT 1997  Richard Henderson  <rth@tamu.edu>

	* obj/obj_reloc.c (obj_relocate): If AXP_BROKEN_GAS, work
	around the old gas local symbol LITERAL reloc bug.

Mon Mar 31 23:03:12 EST 1997  David S. Miller  <davem@jenolan.rutgers.edu>

	* genksyms/lex.l (yylex) [case ST_TABLE_5]: Missing break.

Tue Mar 25 21:41:00 CST 1997  Richard Henderson  <rth@tamu.edu>

	* depmod/depmod.c (old_read_kernel_syms): Get symbols via
	get_kernel_syms syscall rather than /proc/ksyms.

	* depmod/modprobe.c (is_removable): Final arg to query_module
	is a size_t, not an int.

Sat Mar 15 19:34:07 PST 1997  H.J. Lu  <hjl@gnu.ai.mit.edu>

	* depmod/conf_file.c (release_all_sets): Set mod_set to NULL.
	(read_config_file): only call release_all_sets () once.
	call resolve_string () to expand string.

	* depmod/misc.c (resolve_string): New function that resolves
	string with `foo`.
	(what_command): New function that returns the known commands.
	(expand_command): New funtion that expands pattern or
	command. Only `uname -r` is supported this time.

	* depmod/misc.h: New prototype for resolve_string ().

	* depmod/modprobe.c (read_deps_file): call resolve_string () to
	expand string.

	* man/depmod.1: Fix typos. The syntax should be "path[TAG]=PATHNAME"
	means TAG is appended to PATHNAME.

Thu Mar 13 13:38:12 CST 1997  Richard Henderson  <rth@tamu.edu>

	* insmod/insmod.c (ncv_strcmp): New function that combines old
	m_strcmp and k_strcmp -- it's not a simple matter to always have
	the versioned symbol as the first or second argument.
	(main): Install ncv_strcmp instead.
	Reported by David Bourgin <dbourgin@wsc.com>.

	* insmod/insmod.c (get_kernel_version): Take an extra argument to
	return the full uname string.
	(old_get_module_version): Likewise.
	(new_get_module_version): Likewise.
	(main): Record and compare the full uname string, to handle
	suffixes like "-ISS" and "-SMP".

Sun Mar  9 23:52:18 CST 1997  Richard Henderson  <rth@tamu.edu>

	* genksyms/lex.l (yylex): Only use the file component of the input
	path when generating the output filename.
	Reported by Markus Dickebohm <m.dickebohm@uni-koeln.de>.

	* depmod/Makefile (clean): Remove modprobe and depmod.

Sun Mar  9 13:55:27 MET 1997  Eddie C. Dost  <ecd@skynet.be>

	* obj/obj_sparc.c (arch_apply_relocation): Handle lots
	more relocation types.

Tue Mar  4 08:12:58 CST 1997  Richard Henderson  <rth@tamu.edu>

	* Merge new depmod from Marcin Dalecki
	<dalecki@sub994.sub.uni-goettingen.de>.

	* insmod/insmod.c (get_kernel_version): Don't assert that the last
	number of the version be followed by a NUL.
	(old_get_module_version, new_get_module_version): Likewise.
	Reported by Keith Owens <kaos@ocs.com.au>

	* insmod/insmod.c: Merge character and string array patches
	from Jean Tourrilhes <jt@hplb.hpl.hp.com>.

	* kerneld/kerneld.c (kerneld_error): Add missing va_end; use vsnprintf.

Sun Feb  2 13:21:39 CST 1997  Richard Henderson  <rth@tamu.edu>

	* genksyms/lex.l (yylex): Update documentation on 2.0.x symbol table
	processing.  Generate phrases for asm blocks as well, as it is more
	efficient to do it in the lexer.
	* genksyms/parse.y (opt_asm_phrase, asm_declaration): Recognise 
	the ASM_PHRASE token rather than trying to work it out ourselves.

Sun Feb  2 07:44:00 CST 1997  Richard Henderson  <rth@tamu.edu>

	* man/kerneld.8: Format for section 8.
	* man/genksyms.8: Renamed from genksyms.1 to match how it formats.
	Reported by Martin von Loewis <martin@mira.isdn.cs.tu-berlin.de>.

Tue Jan 28 21:10:07 MET 1997  Janos Farkas  <chexum@shadow.banki.hu>

	* depmod/load_obj.cc (load_obj): Close the file when finished.

Mon Jan 27 10:39:21 MET 1997  Geert Uytterhoeven  <geert@cs.kuleuven.ac.be>

	* depmod/config.cc (aliaslist): Add entries for m68k binfmt_aout,
	atarimouse and amigamouse.

Sun Jan 26 14:26:00 CST 1997  Richard Henderson  <rth@tamu.edu>

	Release version 2.1.23.

Wed Jan 22 16:13:54 CST 1997  Richard Henderson  <rth@tamu.edu>

	* insmod/insmod.c (main): Don't call create_module at all if noload.

	* insmod/insmod.c (ncv_symbol_hash): New function to not hash the
	crc portion of the symbol for when the kernel and object file
	don't agree about symbol versioning.
	(main): Install it with the special compare functions.
	* obj/obj_common.c: Move obj_symbol_cmp into obj_file.
	(obj_elf_hash_n): New function derived from old elf_hash.
	(obj_add_symbol): Call the functions in obj_file.
	(obj_find_symbol): Likewise.
	(obj_set_symbol_compare): Accept a new argument `hash' and if set,
	rehash all of the existing symbols with the new function.

Wed Jan 22 15:08:33 CST 1997  Richard Henderson  <rth@tamu.edu>

	* obj/obj_common.c: Split off all of the relocation bits into ...
	* obj/obj_reloc.c: here.
	(obj_allocate_commons_and_check_undefineds): Allocate data for
	NOBITS sections, so that argument initialization and string
	patching works properly.  Reported by <Alain.Knaff@poboxes.com>.
	(obj_create_image): Don't treat NOBITS specially.
	* obj/Makefile (LIBOBJ_OBJS): Add obj_reloc.o.

Fri Jan 17 12:56:58 CST 1997  Richard Henderson  <rth@tamu.edu>

	* genksyms/parse.y (init_declarator): Use new asm_phrase_opt instead
	of asm_definition_opt, as the later eats a semicolon.

Fri Jan 17 10:55:31 EST 1997  David Miller <davem@caipfs.rutgers.edu>

	* genksyms/genksyms.c (print_list): Don't assume alloca returns
	consecutive chunks of down-growing stack.
	(expand_and_crc_list): Likewise.

	* obj/obj_sparc.c (arch_apply_relocation): Do R_SPARC_WDISP22.

Wed Jan 15 14:04:35 CST 1997  Richard Henderson  <rth@tamu.edu>

	* insmod/insmod.c (old_init_module): Or in OLD_MOD_AUTOCLEAN
	when appropriate.

	* insmod/lsmod.c (new_lsmod): Display module use count.

Mon Jan  6 16:06:49 CST 1997  Richard Henderson  <rth@tamu.edu>

	* obj/obj_m68k.c: #include <stddef.h> for size_t.
	* obj/obj_sparc.c: Likewise.

	* insmod/rmmod.c (old_get_modules): Fix error check from read.
	
Sat Jan  4 16:46:09 CST 1997  Richard Henderson  <rth@tamu.edu>

	* insmod/insmod.c (main): Check that we did find the module's 
	kernel version rather than reporting version 255.255.255.
	Reorder obj_load call to remove `may be used uninialized' warning.

	* util/xstrdup.c (xstrdup): Fix `return discards const' warning.

	* insmod/lsmod.c (old_lsmod): Fix error check from read.

	* insmod/ksyms.c (old_ksyms): Initialize kmem_fd.

	* depmod/Makefile (modprobe): Link with $(CC) so that we don't
	pull in a dependancy for libg++.so etc.

Sat Jan  4 16:27:11 EST 1997  Jacques Gelinas  <jack@solucorp.qc.ca>

	* insmod/insmod.c (old_init_module): Fix comparison against
	ksymidx.  The 2.0.x init_module syscall expects the submitted
	module image to skip the mod_use_count_ variable.

	* depmod/config.cc (aliaslist): Add entries for ide-probe and ide-tape.

Fri Jan  3 02:43:00 CST 1997  Richard Henderson  <rth@tamu.edu>

	Snapshot looking towards a 2.1.21 release.
